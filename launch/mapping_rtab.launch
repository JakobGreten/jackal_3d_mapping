<launch>
    
    <!-- Activating use_sim_time for use with bag file -->
    <param name="use_sim_time"  value="true" />
    
    <!-- Relay the point cloud from the lidar_points_filtered topic to the points topic -->
    <node pkg="topic_tools" type="relay" name="relay_lidar" args="/lidar_points_filtered /points"
    output="screen"/>

    <!-- Relay the point cloud from the zed_points_filtered topic to the points topic -->
    <node pkg="topic_tools" type="relay" name="relay_zed" args="/zed_points_filtered /points"
    output="screen"/>
    
    
    <!-- Publish a static transformer between the base_link and the zed_tracking_base_link frame -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_zed_tracking_base_link" args="0 0 0 0 0 0       /zed_tracking_base_link /base_link" />
    
    <!-- Publish a static transformer between the rtab_map and the map frame -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="map_to_zed_map" args="0 0 0 0 0 0        /map /rtab_map" />
    
    <!-- Track the pose estimate for comparison -->
    <include file="$(find jackal_3d_mapping)/launch/trajectory_tracker.launch"/>
    
    
    <!-- Start the octomap server -->
    <include file="$(find jackal_3d_mapping)/launch/jackal_octomap_mapping.launch"/>

    <!-- Start RTAB -->
    <include file="$(find jackal_3d_mapping)/launch/rtabmap.launch"/>
        
    
    <!-- Convert the point cloud from the ZED camera to a depth cloud -->
    <include file="$(find jackal_3d_mapping)/launch/depthcloud_to_pointcloud.launch">
        <arg name="generate_colored_pointcloud" default="false"/>
    </include>
    
    <!-- Filter the point cloud from the ZED camera -->
    <node name="filter_zed" pkg="jackal_3d_mapping" type="filter_zed" output="screen"/>
    
    <!-- Filter the point cloud from the OS1 lidar -->
    <node name="filter_lidar" pkg="jackal_3d_mapping" type="filter_lidar" output="screen"/>
    
    <!-- Start rviz -->
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find jackal_3d_mapping)/rviz/octomap_gmapping.rviz" output="screen" />
    </launch>
